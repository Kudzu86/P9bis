{% extends 'base.html' %}

{% block title %}Détails du Ticket{% endblock %}

{% block content %}
    <div class="ticket-detail-container">
        <h3>{{ ticket.title }}</h3>
        <p class="text-user">{{ ticket.description }}</p>
        <p>Posté par : {{ ticket.user.username }}</p>
        <p>Date : {{ ticket.time_created }}</p>

        {% if user == ticket.user %}
            <div class="ticket-actions">
                <!-- Lien stylisé en bouton pour modifier le ticket -->
                <a href="{% url 'edit_ticket' ticket.id %}" class="btn btn-primary" role="button">Modifier</a>

                <!-- Bouton pour supprimer le ticket -->
                <form action="{% url 'delete_ticket' ticket.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">Supprimer</button>
                </form>
            </div>
        {% else %}
            <!-- Bouton "Répondre" pour répondre à une demande de critique (en vert) -->
            <a href="{% url 'ticket_response' ticket.id %}" class="btn btn-success">Répondre</a>
        {% endif %}

        <h3>Critiques :</h3>
        {% if reviews %}
            <ul>
            {% for review in reviews %}
                <li>
                    <h4>{{ review.headline }} - {{ review.rating }} / 5</h4>
                    <p class="text-user">{{ review.body }}</p>
                    <p>Posté par : {{ review.user.username }}</p>
                    <p>Date : {{ review.time_created }}</p>
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p>Aucune critique pour ce ticket.</p>
        {% endif %}
    </div>
{% endblock %}
